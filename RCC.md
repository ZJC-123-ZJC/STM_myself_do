# RCC

创作者：张锦程

时间：2021.8.1

复位与时钟控制

使用CubeMX配置时钟以及生成代码

## 原理部分（详见参考手册）

当以下事件中的一件发生时，产生一个系统复位： 

1. NRST引脚上的低电平(外部复位)
2. 窗口看门狗计数终止(WWDG复位) 
3. 独立看门狗计数终止(IWDG复位)
4. 软件复位(SW复位)
5. 低功耗管理复位 

可通过查看RCC_CSR控制状态寄存器中的复位状态标志位识别复位事件来源。

------

当以下事件中之一发生时，产生电源复位： 

1. 上电/掉电复位(POR/PDR复位)
2. 从待机模式中返回 电源复位将复位除了备份区域外的所有寄存器

------

时钟总括：

1. STM32时钟系统主要的目的就是给相对独立的外设模块提供时钟，也是为了降低整个芯片的耗能。
   系统时钟，是处理器运行时间基准（每一条机器指令一个时钟周期）

2. 时钟是单片机运行的基础，时钟信号推动单片机内各个部分执行相应的指令。

3. 一个单片机内提供多个不同的系统时钟，可以适应更多的应用场合。

4. 不同的功能模块会有不同的时钟上限，因此提供不同的时钟，也能在一个单片机内放置更多的功能模块。

5. 对不同模块的时钟增加开启和关闭功能，可以降低单片机的功耗

6. STM32为了低功耗，他将所有的外设时钟都设置为disable(不使能)，用到什么外设，只要打开对应外设的时钟就可以， 其他的没用到的可以还是disable(不使能)，这样耗能就会减少。  这就是为什么不管你配置什么功能都需要先打开对应的时钟的原因

   原文链接：https://blog.csdn.net/as480133937/article/details/98845509

三种不同的时钟源可被用来驱动系统时钟(SYSCLK)：

 **● HSI振荡器时钟 （高速内部时钟）**

**● HSE振荡器时钟 （高速外部时钟）**

**● PLL时钟（锁相环倍频时钟）**

![img](https://img-blog.csdnimg.cn/2019080810214187.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2FzNDgwMTMzOTM3,size_16,color_FFFFFF,t_70)

当HSI被用于作为PLL时钟的输入时，系统时钟能得到的最大频率是36MHz。

用户可通过多个预分频器配置AHB、高速APB(APB2)和低速APB(APB1)域的频率。AHB和 APB2域的最大频率是72MHz。APB1域的最大允许频率是36MHz。



**APB1上面连接的是低速外设**，包括电源接口、备份接口、CAN、USB、I2C1、I2C2、USART2、USART3、UART4、UART5、SPI2、SP3等；

**而APB2上面连接的是高速外设**，包括UART1、SPI1、Timer1、ADC1、ADC2、ADC3、所有的普通I/O口（PA-PE）、第二功能I/O（AFIO）口等。 	
